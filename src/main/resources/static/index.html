<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>SLF REPORT</title>
  <link rel="stylesheet" href="//code.jquery.com/ui/1.13.2/themes/base/jquery-ui.css">
  <script src="https://code.jquery.com/jquery-3.6.0.js"></script>
  <script src="https://code.jquery.com/ui/1.13.2/jquery-ui.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">

<!-- Latest compiled JavaScript -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
  <script>
  
  $( function() {
	    var dateFormat = "yyyy-mm-dd",
	      from = $( "#from" )
	        .datepicker({
	          defaultDate: "+1w",
	          changeMonth: true,
	          numberOfMonths: 1
	        })
	        .on( "change", function() {
	          to.datepicker( "option", "minDate", getDate( this ) );
	        }),
	      to = $( "#to" ).datepicker({
	        defaultDate: "+1w",
	        changeMonth: true,
	        numberOfMonths: 1
	      })
	      .on( "change", function() {
	        from.datepicker( "option", "maxDate", getDate( this ) );
	      });
	 
	    function getDate( element ) {
	      var date;
	      try {
	        date = $('#from').datepicker.parseDate( dateFormat, element.value );
	      } catch( error ) {
	        date = null;
	      }
	 
	      return date;
	    }
	  } );
  
  $(document).ready(function(){
	  $("button").click(function(){
		  var dateFormat = "yyyy-mm-dd";
		  
		  var fromDate=(new Date($('#from').datepicker("getDate"))).toISOString().split('T')[0];
		  var toDate=(new Date($('#to').datepicker("getDate"))).toISOString().split('T')[0];
		  
	    $.ajax({url: "../slfReport?fromDate="+fromDate+"&toDate="+toDate,
	    		type: 'GET',  
	    		success: function(result){
			      $("#totalNoOfInident").html(createTable(result.totalNoOfIncident));
			      $("#taskIncident").html(createTable(result.taskIncident));
			      $("#openShiftIncident").html(createTable(result.openShiftIncident));
			      $("#landingIncident").html(createTable(result.landingIncident));
			      $("#batchesIncident").html(createTable(result.batchesIncident));
			      $("#idsIncident").html(createTable(result.idsIncident));
			      $("#dataClarificationIncident").html(createTable(result.dataClarificationIncident));
			      $("#dataCorrectionIncident").html(createTable(result.dataCorrectionIncident));
			      
	    }});
	    
	  });
	  
	  function createTable(obj){
		  var text= "<table class='table'><tr><th>Priority</th><th>Value</th></tr>";
		    	for(var key in obj){
		    		if(obj[key]=="0"){
		    			text+="<tr><td>"+key+"</td><td>"+obj[key]+"</td></tr>"
		    		} else {
		    			text+="<tr style='background-color: rgba(72, 113, 248, 0.068);'><td>"+key+"</td><td>"+obj[key]+"</td></tr>"
		    		}
		    	}
  			text+="</table>";
  			return text;
	  }
	});
  </script>
</head>
<body>

<h2 class="bg-info border d-flex aligns-items-center justify-content-center" >SLF Report</h2>
 <div class="container">
<label for="from">From</label>
<input type="text" id="from" name="from">
<label for="to">to</label>
<input type="text" id="to" name="to">
<button>submit</button>
</div>

<div>

<div class="container mt-3">
<div class="card">
  <div class="card-header">Total Number of Incidents</div>
  <div class="card-body" id="totalNoOfInident"></div>
</div>
</div>

<div class="container">
<div class="card">
  <div class="card-header">Task Incidents</div>
  <div class="card-body" id="taskIncident"></div>
</div>
</div>
<div class="container">
<div class="card">
  <div class="card-header">Open Shift Incidents</div>
  <div class="card-body" id="openShiftIncident"></div>
</div>
</div>
<div class="container">
<div class="card">
  <div class="card-header">Landing Incidents</div>
  <div class="card-body" id="landingIncident"></div>
</div>
</div>
<div class="container">
<div class="card">
  <div class="card-header">Batches Incidents</div>
  <div class="card-body" id="batchesIncident"></div>
</div>
</div>
<div class="container">
<div class="card">
  <div class="card-header">IDRS Incidents</div>
  <div class="card-body" id="idsIncident"></div>
</div>
</div>
<div class="container">
<div class="card">
  <div class="card-header">Data Clarification  Incidents</div>
  <div class="card-body" id="dataClarificationIncident"></div>
</div>
</div>
<div class="container">
<div class="card">
  <div class="card-header">Data Correction Incidents</div>
  <div class="card-body" id="dataCorrectionIncident"></div>
</div>
</div>



</div>
 
</body>
</html>